{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "ProtectAviatrixIamByTag1",
            "Effect": "Deny",
            "NotAction": [
                "iam:Get*",
                "iam:List*"
            ],
            "Resource": [
                "*"
            ],
            "Condition": {
                "StringEqualsIgnoreCase": {
                    "aws:ResourceTag/ApplicationName": ["Aviatrix"]
                },
                "StringNotLike": {
                    "aws:PrincipalArn": [
                        "arn:aws:iam::*:role/Cloud-Admin",
                        "arn:aws:iam::*:role/aviatrix-role-app*"
                    ]
                }
            }
        },
        {
            "Sid": "ProtectAviatrixIamByTag2",
            "Effect": "Deny",
            "NotAction": [
                "iam:Get*",
                "iam:List*"
            ],
            "Resource": [
                "*"
            ],
            "Condition": {
                "StringEqualsIgnoreCase": {
                    "aws:ResourceTag/Aviatrix-Created-Resource": ["Do-Not-Delete-Aviatrix-Created-Resource"]
                },
                "StringNotLike": {
                    "aws:PrincipalArn": [
                        "arn:aws:iam::*:role/Cloud-Admin",
                        "arn:aws:iam::*:role/aviatrix-role-app*"
                    ]
                }
            }
        },
        {
            "Sid": "ProtectAviatrixEc2",
            "Effect": "Deny",
            "NotAction": [
                "ec2:Describe*",
                "ec2:Get*",
                "ec2:List*"
            ],
            "Resource": [
                "*"
            ],
            "Condition": {
                "StringEqualsIgnoreCase": {
                    "ec2:ResourceTag/ApplicationName": [
                        "Aviatrix"
                    ]
                },
                "StringNotLike": {
                    "aws:PrincipalArn": [
                        "arn:aws:iam::*:role/Cloud-Admin",
                        "arn:aws:iam::*:role/aviatrix-role-app*"
                    ]
                }
            }
        }
    ]
}
